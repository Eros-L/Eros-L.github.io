---
title: Notebook
date: 2019-01-01 00:00:00
description: 个人分享。
categories:
 - share
tags: 
- note
---

# Note

---

## 1 Python

### 1.1 简介

主要参考 [Python 基础教程](https://www.runoob.com/python/python-tutorial.html) 与 [Python 3 教程](https://www.runoob.com/python3/python3-tutorial.html)。由于部分特性不常用或者没接触过，我们将不会深入讨论部分章节。

#### 1.1.1 特点

- 动态类型语言
    - 运行期间才做数据类型检查的语言，即动态类型语言编程时，永远不用给任何变量指定数据类型。
- 強类型语言
    - 不容忍隐式类型转换。一旦变量被指定某个数据类型，如果不经强制转换，即永远是此数据类型。
- 脚本语言
    - 逐行翻译并执行代码。由于缺少了编译过程，即使后面代码中存在语法错误也不影响前面代码的执行。
- 面向对象语言
    - ***封装***：封装成若干个独立单元，只提供接口。能够减少耦合度，提高代码安全性，方便后续修改。 <br />
    ***继承***：类可以通过另一个类派生而来，新类被称作派生类，原来的类被称作基类，派生类继承了基类的成员方法和变量，并且可以在类里增加自己的特性函数变量实现特定功能。能够提高代码的重用率。 <br />
    ***多态***：允许不同类对象对同一消息做出反应，同一消息被不同的对象响应可以造成不同的结果。假设类 A 为类 B 的派生类，那么 A 的一个实例 a 将同时拥有 A 与 B 两种状态。进一步假设 B 有类函数 f，那么 A 的实例与 B 的实例都可以直接调用 f，且 A 可以通过重载 f 实现与 B 不一样的功能。
- 解释型语言
    - 不需要编译成二进制代码，可以直接从源代码运行程序。

#### 1.1.2 优点

- 易于学习、阅读与维护。
- 有广泛的基础库与大量强大的三方库，能够提高开发效率。
- 属于高级语言，不需要我们考虑底层细节。
- 具有可移植性，使程序能够轻易移植到不同的系统平台上。
- 具有可扩展性，允许我们在 python 程序中使用 C/C++ 编写的代码（使用 C/C++ 能提升运行速度并支持代码加密）。
- 具有可嵌入性，允许我们将 python 嵌入到 C/C++ 程序中。
- 可通过 shell 互动执行代码。
- 提供所有主要的商业数据库的接口。

#### 1.1.3 缺点

- 运行速度慢。
- 代码无法加密。
- 多线程无法利用多核 CPU。

### 1.2 环境

#### 1.2.1 解析器

在脚本第一行添加以下代码能够指定脚本的解析器。

```
#!/usr/bin/python3
```

使用以下代码则允许通过环境设置寻找解析器路径。

```
#!/usr/bin/env python3
```

#### 1.2.2 编码

可在脚本头添加以下代码指定编码格式。

```
# -*- coding: utf-8 -*-
```


utf-8 能支持中文的读取。且外，使用 pickle 读取文件时，有时需要用到 iso-8859-1（欧洲语言）。

### 1.3 基础

#### 1.3.1 标识符

在 python 中，所有标识符可以包括英文（区分大小写）、数字以及下划线，但不能以数字开头。

```
foo     # 合法
FOO     # 合法
foo123  # 合法
f_oo    # 合法
foo_    # 合法
123foo  # 非法
```

其中，以下划线开头的标识符是有特殊意义的。

```
# class definition
class A:
    # 代表不能直接访问的类属性，需通过类提供的接口进行访问。
    # 不能用 from xxx import * 而导入。
    def _foo(self):
        pass
    
    # 代表类的私有成员。
    def __foo(self):
        pass

    # 代表 Python 里特殊方法专用的标识，如 __init__() 代表类的构造函数。
    def __foo__(self):
        pass

# main function
a = A()

a._foo()        # 可以调用，但是会有 warning

a.__foo()       # 无法调用，会报错
a._A__foo()     # 强行在外部调用 a._foo()
```

在 python 中，使用分号能令同一行显示多条语句。

```
print("hello"); print("world");
```

#### 1.3.2 保留字

||||
|:-:|:-:|:-:|
|and（逻辑与）|exec（执行储存在字符串或文件中的Python语句）|not（逻辑非）|
|assert（断言）|finally（异常捕捉）|or（逻辑或）|
|break（终止循环）|for（循环）|pass（空语句）|
|class（类定义）|from（指定域）|print（打印）|
|continue（跳过循环）|global（全局变量修饰词）|raise（引发异常）|
|def（函数定义）|if（条件）|return（返回）|
|del（解除引用）|import（导入）|try（异常捕捉）|
|elif（等同于 else if）|in（成员运算符）|while（循环）|
|else（条件）|is（对象比较）|with（上下文管理，try ... finally 的简写）|
|except（异常捕捉）|lambda（lambda 表达式）|yield（生成器）|
|as（赋值）|None（空值）||

#### 1.3.3 格式

python 的代码块不使用 {}，而是使用缩进，来控制类、函数以及其他逻辑判断。缩进的空白数量是可变的，但是所有代码块语句必须包含相同的缩进空白数量。

```
if True:
    print ("Answer")
    print ("True")
else:
    print ("Answer")
    # 没有严格缩进，在执行时会报错
  print ("False")
```

在 python 中，我们可以使用（ \ ）将一行的语句分为多行显示。若语句中包含 [], {} 或 () 则不需要使用多行连接符。

```
sum = 1 + \
      2 + \
      3

days = ['Monday', 'Tuesday', 'Wednesday',
        'Thursday', 'Friday']
```

python 可以使用引号( ' )、双引号( " )、三引号( ''' 或 """ ) 来表示字符串，引号的开始与结束必须的相同类型的。

```
word = 'word'
sentence = "这是一个句子。"
paragraph = """这是一个段落。
               包含了多个语句"""
```

python中单行注释采用 # 开头；多行注释使用三个单引号或三个双引号。

```
# 单行注释

'''
多行注释
多行注释
'''

"""
多行注释
多行注释
"""
```

#### 1.3.4 输入与输出

input() 函数，能接收任意输入，将所有输入默认为字符串处理，并返回字符串类型。

```
a = input("please input an integer: ")
print(a, type(a))

b = input("please input a float number: ")
print(b, type(b))

c = input("please input a string: ")
print(c, type(c))
```

### 1.4 变量类型

python 的标准数据类型有：

- Numbers（数字）
- String（字符串）
- List（列表）
- Tuple（元组）
- Dictionary（字典）

使用下面代码进行赋值，能够让代码更简洁：

```
a = b = c = 1

a, b, c = 2020, 3.14, 'python'
```

#### 1.4.1 Numbers

Numbers 包括以下类型：

- int（整型）
- float（浮点型）
- complex（复数）

|int|float|complex|
|:-:|:---:|:-----:|
|10|0.0|3.14j|
|100|15.20|45.j|
|-786|-21.9|9.322e-36j|
|080|32.3e+18|.876j|
|-0490|-90.|-.6545+0J|
|-0x260|-32.54e100|3e+26J|
|0x69|70.2E-12|4.53e-7j|

在 python 中，二进制数以 0b 开头（如 0b10 == 2）；八进制数以 0o 开头（如 0o10 == 8）；十六进制数以 0x 开头（如 0x10 == 16）。且外，复数（常见于滤波算法）由实数部分和虚数部分构成，可以用 a + bj,或者 complex(a,b) 表示， 复数的实部 a 和虚部 b 都是浮点型。一般情况下，我们可能不需要用到二进制数、八进制数、十六进制数与复数。在处理大数字时，使用科学计数法能让代码更简洁（如 1e3 == 1000）。

numpy 支持的数据类型比 Python 内置的类型要多很多，基本上可以和 C 语言的数据类型对应上，其中部分类型对应为 Python 内置的类型。详情可参考 [NumPy 数据类型](https://www.runoob.com/numpy/numpy-dtype.html)。且外，np.inf（正无穷） 与 np.nan（无效值） 也非常实用。

#### 1.4.2 String

python 不支持单字符类型，单字符在 python 中也是作为一个字符串使用。

```
var1 = 'python'
var2 = 'p'
```

python 访问子字符串，可以使用方括号来截取字符串。

```
print(var1[1:4])
print(var2[0])
```

在需要在字符中使用特殊字符时，我们要使用以下转义字符：

- \，续行符
- \\\\，反斜杠
- \\'，单引号
- \\"，双引号
- \n，换行符
- \t，制表符
- \a，在 shell 中输入时 print("\a") 时，系统会发出响铃声
- \b，退格符，执行 print("xy\bz") 会得到 xz
- \r，回车符
- \v，纵向制表符
- \f，换页符
- \000，空

在 python 中，字符串支持以下运算符：

- \+
- \*
- []
- [\:]
- in
- not in
- r
- R
- %

python 支持格式化字符串的输出。尽管这样可能会用到非常复杂的表达式，但最基本的用法是将一个值插入到一个有字符串格式符 %s 的字符串中。在 python 中，字符串格式化使用与 C 中 sprintf 函数一样的语法。

python 字符串格式化符号：

- %c，格式化字符及其ASCII码
- %s，格式化字符串
- %d，格式化整数
- %u，格式化无符号整型
- %o，格式化无符号八进制数
- %x，格式化无符号十六进制数
- %X，格式化无符号十六进制数（大写）
- %f，格式化浮点数字，可指定小数点后的精度
- %e，用科学计数法格式化浮点数
- %E，作用同%e，用科学计数法格式化浮点数
- %g，%f和%e的简写
- %G，%f 和 %E 的简写
- %p，用十六进制数格式化变量的地址（在 python3 中不适用）

格式化操作符辅助指令：

- \*，定义宽度或者小数点精度
- \-，用做左对齐
- \+，在正数前面显示加号( + )
- <sp>，在正数前面显示空格
- \#，在八进制数前面显示零('0')，在十六进制前面显示'0x'或者'0X'(取决于用的是'x'还是'X')
- 0，显示的数字前面填充'0'而不是默认的空格
- %，'%%'输出一个单一的'%'
- (var)，映射变量(字典参数)
- m.n.，m 是显示的最小总宽度,n 是小数点后的位数(如果可用的话)

f-string 的细节与更多的字符串内建函数可参考 [Python3 字符串](https://www.runoob.com/python3/python3-string.html)。

#### 1.4.3 List

列表是最常用的 python 数据类型，它可以作为一个方括号内的逗号分隔值出现。列表的数据项不需要具有相同的类型。

访问列表中的值：

```
list1 = ['Google', 'Now', 1997, 2020]
list2 = list(range(1, 7))

print("list1[0]: ", list1[0])
print("list2[1:5]: ", list2[1:5])
```

更新列表：

```
list1 = ['Google', 'Now', 1997, 2020]

print("第三个元素为 : ", list1[2])
list1[2] = 2001
print("更新后的第三个元素为 : ", list1[2])
```

删除列表元素：

```
list1 = ['Google', 'Now', 1997, 2020]

print("原始列表 : ", list1)
del list1[2]
# 或 list1.pop(2)
print("删除第三个元素 : ", list1)
```

更多细节可参考 [Python3 列表](https://www.runoob.com/python3/python3-list.html)。

#### 1.4.4 Tuple

python 的元组与列表类似，不同之处在于元组的元素不能修改。

```
tup1 = ('Google', 'Now', 1997, 2020)
tup2 = (1, 2, 3, 4, 5)
tup3 = "a", "b", "c", "d"       # 不需要括号也可以
print(tup1, tup2, tup3)
```

元组中只包含一个元素时，需要在元素后面添加逗号，否则括号会被当作运算符使用。

```
tup4 = (50)
print(tup4)     # 不加逗号，类型为整型
tup4 = (50,)
print(tup4)     # 加上逗号，类型为元组
```

访问元组：

```
tup1 = ('Google', 'Now', 1997, 2020)
tup2 = (1, 2, 3, 4, 5, 6, 7)

print("tup1[0]: ", tup1[0])
print("tup2[1:5]: ", tup2[1:5])
```

修改元组：元组中的元素值是不允许修改的，但我们可以对元组进行连接组合

```
tup1 = ('Google', 'Now', 1997, 2020)
tup2 = (1, 2, 3, 4, 5, 6, 7)

tup3 = tup1 + tup2
print(tup3)
```

删除元组：元组中的元素值是不允许删除的，但我们可以使用del语句来删除整个元组

```
tup1 = ('Google', 'Now', 1997, 2020)
tup2 = (1, 2, 3, 4, 5, 6, 7)

tup3 = tup1 + tup2
del tup3
print(tup3)
```

更多细节可参考 [Python3 元组](https://www.runoob.com/python3/python3-tuple.html)。

#### 1.4.5 Dictionary

字典是另一种可变容器模型，且可存储任意类型对象。字典的每个键值 (key => value) 对用冒号分割，每个对之间用逗号分割，整个字典包括在花括号中。

```
dict1 = {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}

dict2 = { 'abc': 456 }
dict3 = { 'abc': 123, 98.6: 37 }
```

访问字典里的值：

```
dict1 = {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}

print("dict['Alice']: ", dict1['Alice'])
print("dict['Cecil']: ", dict1['Cecil'])
```

修改字典：

```
dict1 = {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}

dict1['Alice'] = '1432'
dict1['Eddie'] = '1996'
print(dict1)
```

删除字典元素：

```
dict1 = {'Alice': '2341', 'Beth': '9102', 'Cecil': '3258'}

del dict1['Eddie']
# dict1.clear() 清空字典
print(dict1)
```

字典的特性：

- 不允许同一个键出现两次。创建时如果同一个键被赋值两次，后一个值会被记住。
- 键必须不可变，所以可以用数字，字符串或元组充当，而用列表就不行。
- 字典查找速度快,无论有10个元素还是10万个元素，查找速度都一样。而列表的查找速度随着元素增加而逐渐下降。不过查找速度快不是没有代价的，缺点是占用内存大，还会浪费很多内容，列表正好相反，占用内存小，但是查找速度慢。
- 字典值可以没有限制地取任何python对象，既可以是标准的对象，也可以是用户定义的。
- 字典存储的key-value序对是没有顺序的。

综上，假设我们需要频繁使用查找操作，使用 dict 会更加合理。

```
list1 = list(range(int(1e6)))
dict1 = dict(zip(list1, list1))

print(54502 in list1)
print(54502 in dict1)
```

更多细节可参考 [Python3 字典](https://www.runoob.com/python3/python3-dictionary.html)。

且外，某些情况下，集合可以是字典的一个替代。

### 1.5 运算符

Python语言支持以下类型的运算符：

- 算术运算符
- 比较（关系）运算符
- 赋值运算符
- 逻辑运算符
- 位运算符
- 成员运算符
- 身份运算符

更多细节可参考 [Python 运算符](https://www.runoob.com/python/python-operators.html)。

其中，**（幂运算）与 //（整除运算）是比较实用却容易被忽略的算术运算符。

### 1.6 条件语句

python 条件语句是通过一条或多条语句的执行结果（True 或者 False）来决定执行的代码块。

```
if expression:
    operation
elif expression:
    operation
else:
    operation
```

由于 python 并不支持 switch 语句，所以多个条件判断，只能用 elif 来实现。且外，你也可以在同一行的位置上使用 if 条件判断语句（在我看来，不是一个好习惯）。

```
var = 100
if var == 100: print("变量 var 的值为100") 
```

如果接触过 C++ 的话，那可能会听说过条件运算符（a ? b : c）。在 python 中，我们也可以使用类似的语法糖（某些情况下，能够让代码更简洁）。

```
def isOdd(num):
    return ("%d 是一个奇数" if num % 2 == 1 else "%d 不是一个奇数") % num

print(isOdd(241))
print(isOdd(8832))

>> 241 是一个奇数
>> 8832 不是一个奇数
```

### 1.7 循环语句

循环语句允许我们执行一个语句或语句组多次。python 提供了 for 循环和 while 循环。

for 循环：

```
for var in sequence:
    statements
```

while 循环：

```
while condition:
    statements
```

循环控制语句可以更改语句执行的顺序。python支持以下循环控制语句：

- break
- continue
- pass

### 1.8 日期与时间

可参考 [Python 日期和时间](https://www.runoob.com/python/python-date-time.html)。

在这里，我们简略地介绍下几种常用的应用。

计算某段代码的执行时间：

```
import time

tick = time.time()

for i in range(int(1e8)):
    pass

print("executed in %f seconds" % (time.time() - tick))
```

将时间戳转换为日期（一种特征工程）：

```
import time

print(time.localtime(20647191))

>> time.struct_time(tm_year=1970, tm_mon=8, tm_mday=28, tm_hour=7, tm_min=19, tm_sec=51, tm_wday=4, tm_yday=240, tm_isdst=0)
```

格式化日期：

```
import time

print(time.strftime("%Y-%m-%d %H:%M:%S %a", time.localtime()))
```

python 中时间日期格式化符号：
- %y，两位数的年份表示（00-99）
- %Y，四位数的年份表示（000-9999）
- %m，月份（01-12）
- %d，月内中的一天（0-31）
- %H，24小时制小时数（0-23）
- %I，12小时制小时数（01-12）
- %M，分钟数（00=59）
- %S，秒（00-59）
- %a，本地简化星期名称
- %A，本地完整星期名称
- %b，本地简化的月份名称
- %B，本地完整的月份名称
- %c，本地相应的日期表示和时间表示
- %j，年内的一天（001-366）
- %p，本地A.M.或P.M.的等价符
- %U，一年中的星期数（00-53）星期天为星期的开始
- %w，星期（0-6），星期天为星期的开始
- %W，一年中的星期数（00-53）星期一为星期的开始
- %x，本地相应的日期表示
- %X，本地相应的时间表示
- %Z，当前时区的名称
- %%，%号本身

将格式字符串转换为时间戳（一种特征工程）：

```
import time

today = "2020-01-04 03:25:50 Sat"
print(time.mktime(time.strptime(today, "%Y-%m-%d %H:%M:%S %a")))
```

### 1.9 函数

函数能提高应用的模块性，和代码的重复利用率。你已经知道Python提供了许多内建函数，比如print()。但你也可以自己创建函数，这被叫做用户自定义函数。

- 函数代码块以 def 关键词开头，后接函数标识符名称和圆括号 ()。
- 任何传入参数和自变量必须放在圆括号中间，圆括号之间可以用于定义参数。
- 函数的第一行语句可以选择性地使用文档字符串—用于存放函数说明。
- 函数内容以冒号起始，并且缩进。
- return [表达式] 结束函数，选择性地返回一个值给调用方。不带表达式的return相当于返回 None。

#### 1.9.1 参数传递

在 python 中，类型属于对象，变量是没有类型的：

```
a = [1,2,3]

a = "Hello"
```

以上代码中，[1,2,3] 是 List 类型，"Hello" 是 String 类型，而变量 a 是没有类型，仅仅是一个对象的引用（一个指针），可以是指向 List 类型对象，也可以是指向 String 类型对象。

在 python 中，strings, tuples, 和 numbers 是不可更改的对象，而 list,dict 等则是可以修改的对象。

- 不可变类型：变量赋值 a = 5 后再赋值 a = 10，这里实际是新生成一个 int 值对象 10，再让 a 指向它，而 5 被丢弃，不是改变a的值，相当于新生成了a。
- 可变类型：变量赋值 la = [1,2,3,4] 后再赋值 la[2] = 5 则是将 list la 的第三个元素值更改，本身la没有动，只是其内部的一部分值被修改了。

python 函数的参数传递：

- 不可变类型：类似 c++ 的值传递，如 整数、字符串、元组。如 fun（a），传递的只是 a 的值，没有影响 a 对象本身。比如在 fun（a）内部修改 a 的值，只是修改另一个复制的对象，不会影响 a 本身。
- 可变类型：类似 c++ 的引用传递，如 列表，字典。如 fun（la），则是将 la 真正的传过去，修改后 fun 外部的la也会受影响。

> 实际开发中，特别需要注意不可变类型与可变类型的区别。

#### 1.9.2 参数

以下是调用函数时可使用的正式参数类型：
- 必需参数
- 关键字参数
- 默认参数
- 不定长参数

必需参数须以正确的顺序传入函数。调用时的数量必须和声明时的一样。

关键字参数和函数调用关系紧密，函数调用使用关键字参数来确定传入的参数值。使用关键字参数允许函数调用时参数的顺序与声明时不一致，因为 Python 解释器能够用参数名匹配参数值。

调用函数时，如果没有传递参数，则会使用默认参数。

你可能需要一个函数能处理比当初声明时更多的参数。这些参数叫做不定长参数，和上述参数不同，声明时不会命名。

#### 1.9.3 匿名函数

python 使用 lambda 来创建匿名函数。所谓匿名，意即不再使用 def 语句这样标准的形式定义一个函数。

- lambda 只是一个表达式，函数体比 def 简单很多。
- lambda的主体是一个表达式，而不是一个代码块。仅仅能在lambda表达式中封装有限的逻辑进去。
- lambda 函数拥有自己的命名空间，且不能访问自己参数列表之外或全局命名空间里的参数。
- 虽然 lambda 函数看起来只能写一行，却不等同于 C 或 C++ 的内联函数，后者的目的是调用小函数时不占用栈内存从而增加运行效率。

```
lambda [arg1 [,arg2,.....argn]]:expression
```

#### 1.9.4 函数注解

python3 提供一种语法，用于为函数声明中的参数和返回值附加元数据。

- 函数声明中的各个参数可以在：后增加注解表达式。
- 如果参数由默认值，注解放在参数名和 = 号之间。
- 如果注解有返回值，在 ) 和函数末尾的：之间增加 -> 和一个表达式。那个表达式可以是任何类型。注解中最常用的类型是类（如 str 或 int）和字符串（如 'int > 0'）。

python 对注解所做的唯一的事情是，把他们存储在函数的__annotations__属性里。python 不会做任何检查、强制、验证。注解对 python 解释器没任何意义。注解只是元数据，可以供 IDE、框架和装饰器等工具使用。（参数类型不正确或返回类型不正确时，IDE 会有高亮提示。）

### 1.10 迭代器与生成器